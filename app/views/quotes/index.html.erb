<!--
<% if @user.nil? %>
  <h1 class="underline">Hey there stranger!</h1>
<% elsif @user.email.nil? %>
  <h1 class="underline">Hey there <%= @user.name %>!</h1>
<% else %>
  <h1 class="underline">Hey there <%= @user.email %>!</h1>
<% end %>
!-->

<div id="wellsaid-wizard">
  <div class="wizard-1">
      <h2 class="digit">1.</h2><h2>Installing</h2>
      <p>Drag the link below to your bookmarks bar</p>
      <a href='javascript:(function(){
      well = function() {
        try {
          if(!document.body)
            throw(0);

          if(document.getSelection().toString() === "") {
            alert("Empty selection.");
            throw(0);
          } else {
            well      = document.createElement("script");
            selection = document.getSelection().toString();
            source    = document.location.href.toString();
            token     = "<%= @user.token %>";
            url       = "http://wellsaid.herokuapp.com/quotes/add?id=" +token +"&copy=";
            well.src  = url +encodeURIComponent(selection) + "&src=" +source + "&callback=status";
          }

          /* TAKES CARE OF JSONP RESPONSE */
          jsonp = document.createElement("script");
          jsonp.setAttribute("type", "text/javascript");
          callback = "function status(data) {
            headline.innerText = data.message;
            popup.innerHTML = headline.outerHTML;
            counter = 0;
            interval = setInterval(function() {
              counter += 25;
              wait = 350;
              if(counter > wait) {
                value = counter - wait;
                popup.style.opacity = popup.style.opacity - (value/1000);
                document.body.removeChild(popup);
                document.body.appendChild(popup);
                if(counter === 1500) {
                  clearInterval(interval);
                  counter = 0;
                  document.body.removeChild(popup);
                }
              }
            }, 50);
          }";
          jsonp.innerHTML = callback;
          document.body.appendChild(jsonp);
          
          /* CREATES POPUP */
          headline = document.createElement("h1");
          headline.id = "well-title";
          headline.style.fontFamily = "Georgia";
          headline.style.fontSize = "24px";
          headline.style.textAlign = "center";
          headline.style.width = "175px";
          headline.style.color = "#444";
          headline.innerText = "SAVING..";

          popup = document.createElement("div");
          popup.style.backgroundColor = "#eee";
          popup.style.width = "175px";
          popup.style.padding = "25px";
          popup.style.zIndex = "20000";
          popup.style.position = "fixed";
          popup.style.top = "0";
          popup.style.left = "25px";
          popup.style.opacity = "1";
          popup.innerHTML = headline.outerHTML;
          document.body.appendChild(popup);

          /* EXECUTE SCRIPT */
          document.body.appendChild(well);

        } catch(e) {
          alert("Please wait until the page has loaded.");
        }
      };

      if(/Firefox/.test(navigator.userAgent)) {
        setTimeout(well,0);
      } else {
        well();
      }})()' class="pimp">Well Said</a>
  </div>
  <div class="wizard-2">
      <h2 class="digit">2.</h2><h2>Testing</h2>
      <p>Select the text below</p>
      <h3 class="selected">"Unpack your sense of humor, and get on with living and enjoy it."</h3>
  </div>
  <div class="wizard-3">
      <h2 class="digit">3.</h2><h2>Using</h2>
      <p>Click the bookmark you added and then reload the page</p>
  </div>
  <div id="close-wizard" class="underline" style="clear: both;"></div>
</div>
<div class="divider"></div>
<div id="quotes-container">
  <% if !@quotes.nil? %>
  	<% @quotes.each do |quote| %>
  		<%= render :partial => 'quote', locals: { quote: quote } %>
  	<% end %>
  <% end %>
</div>
